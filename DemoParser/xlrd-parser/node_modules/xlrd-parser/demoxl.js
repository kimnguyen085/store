var async = require('async'),
	expect = require('chai').expect,
	xlrd = require(__dirname+'/lib/xlrd'),
	sampleFiles = [
		// OO XML workbook (Excel 2003 and later)
		'myfile.xlsx'
		
	];

//async.eachSeries(sampleFiles, function (file, next) {
//		xlrd.parse(file,{ sheet: 0, maxRows: 10 }, function (err, workbook) {
//
//		if (err) throw err;
//			workbook.sheets.forEach(function (sheet) {
//			console.log('sheet: ' + sheet.name);
//			// Iterate on rows
//	
//			});
//		});
//});		

xlrd.stream(sampleFiles).on('open', function (workbook) {
	console.log('successfully opened ' + workbook.file);
}).on('data', function (data) {

	var crrWb = data.workbook,
		crrSh = data.sheet,
		crrrows = data.rows;
	

	console.log(crrSh.name);
	crrrows.forEach(function(row){
		row.forEach(function (cell) {
				console.log(cell.address + ': ' + cell.value);
		});

	});


}).on('error', function (err) {
//	 TODO: handle error here
}).on('close', function () {
//	 TODO: finishing logic here
});

