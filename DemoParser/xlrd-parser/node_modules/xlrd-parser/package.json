{
  "name": "xlrd-parser",
  "version": "0.1.2",
  "main": "lib/xlrd",
  "description": "High performance Excel file parser based on the xlrd library from www.python-excel.org.",
  "keywords": [
    "excel",
    "xls",
    "xlsx",
    "parse",
    "parsing",
    "xlrd",
    "python-excel"
  ],
  "scripts": {
    "test": "mocha test/*.js",
    "install": "bash install.sh"
  },
  "dependencies": {
    "underscore": "~1.4.4"
  },
  "devDependencies": {
    "async": "*",
    "mocha": "*",
    "chai": "*"
  },
  "repository": {
    "type": "git",
    "url": "http://github.com/extrabacon/xlrd-parser"
  },
  "homepage": "http://github.com/extrabacon/xlrd-parser",
  "bugs": {
    "url": "http://github.com/extrabacon/xlrd-parser/issues"
  },
  "author": {
    "name": "Nicolas Mercier",
    "email": "nicolas@extrabacon.net"
  },
  "engines": {
    "node": ">=0.10"
  },
  "readme": "# xlrd-parser\n\nHigh performance Excel file parser based on the xlrd library from [www.python-excel.org](www.python-excel.org) for\nreading Excel files in XLS or XLSX formats.\n\nThis module interfaces with a Python shell to stream JSON from stdout using a child process. It is not a port of xlrd\nfrom Python to Javascript (which is surely possible).\n\nIMPORTANT: this package is being moved over to the [pyspreadsheet](https://github.com/extrabacon/pyspreadsheet) project, which provides many new features such as writing files. It is based on the same Python/Node hybrid, but integrates with more libraries in order to deliver new features beyond xlrd. As a result, xlrd-parser is no longer under active development.\n\n## Features\n\n+ Much faster and more memory efficient than most alternatives\n+ Uses child processes for isolation and parallelization (will not leak your Node process)\n+ Can stream large files (tested with 250K+ rows)\n+ Support for both XLS and XLSX formats\n+ Can read multiple sheets\n+ Can load data selectively\n+ Accurate parsing of Javascript objects, including strings, numbers, dates, booleans and errors\n\n## Limitations\n\n+ Requires a Python shell (should not be a problem on Unix/Linux)\n+ Does not parse formatting info\n\n## Documentation\n\n### Installation\n```bash\nnpm install xlrd-parser\n```\n\nThe xlrd dependency is installed automatically by downloading the latest version from\n[github](http://github.com/python-excel/xlrd).\n\n### Parsing a file\n\nParsing a file loads the entire file into an object structure composed of a workbook, sheets, rows and cells.\n\n```javascript\nvar xlrd = require('xlrd-parser');\n\nxlrd.parse('myfile.xlsx', function (err, workbook) {\n\t// Iterate on sheets\n\tworkbook.sheets.forEach(function (sheet) {\n\t\tconsole.log('sheet: ' + sheet.name);\n\t\t// Iterate on rows\n\t\tsheet.rows.forEach(function (row) {\n\t\t\t// Iterate on cells\n\t\t\trow.forEach(function (cell) {\n\t\t\t\tconsole.log(cell.address + ': ' + cell.value);\n\t\t\t});\n\t\t});\n\t});\n});\n```\n\n#### Returned object\n\nThe returned object is either a workbook object, or an array of workbook objects if multiple files were specified as the\nsource. The workbook object contains a structure of sheets, rows and cells to represent the data.\n\nThe Workbook object contains the following members:\n\n* `file` - the file used to open the workbook\n* `meta` - metadata for this workbook\n  * `user` - the owner of the file\n  * `sheets` - an array of strings containing the name of sheets (available without any iteration)\n* `sheets` - the array of Sheet objects that were loaded\n\nThe Sheet object contains the following members:\n\n* `index` - the ordinal position of the sheet within the workbook\n* `name` - the name of the sheet\n* `bounds` - an object specifying the data range for the sheet\n  * `rows` - the total number of rows in the sheet\n  * `columns` - the total number of columns in the sheet\n* `visibility` - the sheet visibility - possible values are `visible`, `hidden` and `very hidden`\n* `rows` - the array of rows that were loaded - rows are arrays of Cell objects\n\nThe Cell object contains the following members:\n\n* `row` - the ordinal row number\n* `column` - the ordinal column number\n* `address` - the cell address (\"A1\", \"B12\", etc.)\n* `value` - the cell value\n\nCell values can be of the following types:\n\n* `Number` - for numeric values\n* `Date` - for cells formatted as dates\n* `Error` - for cells with errors, such as #NAME?\n* `Boolean` - for cells formatted as booleans\n* `String` - for anything else\n\nFor more details on the API, see the included unit tests.\n\n### Streaming a large file\n\nFor large files, you may want to stream the data. The stream method returns a familiar EventEmitter instance.\n\n```javascript\nvar xlrd = require('xlrd-parser');\n\nxlrd.stream('myfile.xlsx').on('open', function (workbook) {\n\tconsole.log('successfully opened ' + workbook.file);\n}).on('data', function (data) {\n\n\tvar currentWorkbook = data.workbook,\n\t\tcurrentSheet = data.sheet,\n\t\tbatchOfRows = data.rows;\n\n\t// TODO: handle streaming logic here\n\n}).on('error', function (err) {\n\t// TODO: handle error here\n}).on('close', function () {\n\t// TODO: finishing logic here\n});\n```\n\n#### Events\n\nThe `stream` method returns a Node `EventEmitter` instance. Use `on` to listen to events and read the data continuously.\n\n* `open` - fires when a workbook is opened (sheets are not available at this point)\n\n  Arguments: the workbook object\n\n* `data` - fires repeatedly as data is being read from the file\n\n  Arguments: a data object containing the following:\n\n  * `workbook`: the current workbook object\n  * `sheet`: the current sheet object\n  * `rows`: the current batch of rows\n\n* `error` - fires every time an error is encountered while parsing the file, the process is stopped only if a fatal\nerror is encountered\n\n  Arguments: the error object\n\n* `close` - fires only once, after all files and data have been read\n\n  Arguments: none\n\n### Options\n\nAn object can be passed to the `parse` and `stream` methods to define additional options.\n\n* `meta` - load only workbook metadata, without iterating on rows - `Boolean`\n* `sheet` || `sheets` - load sheet(s) selectively, either by name or by index - `String`, `Number` or `Array`\n* `maxRows` - the maximum number of rows to load per sheet - `Number`\n* `debug` - log output from the xlrd-parser child process - `Boolean`\n\n#### Examples:\n\nOutput sheet names without loading any data:\n\n```javascript\nxlrd.parse('myfile.xlsx', { meta: true }, function (err, workbook) {\n  console.log(workbook.meta.sheets);\n});\n```\n\nLoad only the first 10 rows from the first sheet:\n\n```javascript\nxlrd.parse('myfile.xlsx', { sheet: 0, maxRows: 10 }, function (err, workbook) {\n  // workbook will contain only the first sheet\n});\n```\n\nLoad only a sheet named \"products\":\n\n```javascript\nvar stream = xlrd.stream('myfile.xlsx', { sheet: 'products' });\n```\n\n## Compatibility\n\n+ Tested with Node 0.10.x\n+ Tested on Mac OS X 10.8\n+ Tested on Ubuntu Linux 12.04 (requires prior installation of curl: apt-get install curl)\n\n## Dependencies\n\n+ Python version 2.6+\n+ xlrd version 0.7.4+\n+ underscore\n+ bash (installation script)\n+ curl (installation script)\n\nWindows platform is not yet supported, but it is only a matter of converting the installation script to PowerShell.\nA Python shell also needs to be available from the command line, which could be installed via\n[chocolatey](http://chocolatey.org/packages/python).\n\n## Changelog\n\n### 0.1.2\n\n+ maintenance release, deprecating in favor of [pyspreadsheet](https://github.com/extrabacon/pyspreadsheet)\n\n### 0.1.0\n\n+ can probe a workbook for metadata, without iterating on rows (`options.meta`)\n+ can specify which sheet(s) to load, either by name or by index (`options.sheets`)\n+ can specify a maximum number of rows to load (`options.maxRows`)\n+ parsing of booleans and errors (such as #DIV/0!, #NAME? or #VALUE!)\n+ new optimized Python script, emitted JSON is more compact which should further reduce memory footprint\n+ sheets are always loaded on-demand (using on_demand=True)\n+ better error handling\n+ added JSDoc comments\n\n### 0.0.1\n\n+ initial release\n\n## Thanks\n\nMany thanks to the authors of the xlrd library ([here](http://github.com/python-excel/xlrd)). It is the best and most\nefficient open-source library I could find.\n\n## License\n\nThe package itself is MIT licenced.\n\nLicense from xlrd library:\n\n\tPortions copyright Â© 2005-2009, Stephen John Machin, Lingfo Pty Ltd\n\tAll rights reserved.\n\n\tRedistribution and use in source and binary forms, with or without\n\tmodification, are permitted provided that the following conditions are met:\n\n\t1. Redistributions of source code must retain the above copyright notice,\n\tthis list of conditions and the following disclaimer.\n\n\t2. Redistributions in binary form must reproduce the above copyright notice,\n\tthis list of conditions and the following disclaimer in the documentation\n\tand/or other materials provided with the distribution.\n\n\t3. None of the names of Stephen John Machin, Lingfo Pty Ltd and any\n\tcontributors may be used to endorse or promote products derived from this\n\tsoftware without specific prior written permission.\n\n\tTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n\tAND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,\n\tTHE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n\tPURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS\n\tBE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n\tCONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n\tSUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n\tINTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n\tCONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n\tARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF\n\tTHE POSSIBILITY OF SUCH DAMAGE.\n\n\t/*-\n\t * Copyright (c) 2001 David Giffin.\n\t * All rights reserved.\n\t *\n\t * Based on the the Java version: Andrew Khan Copyright (c) 2000.\n\t *\n\t *\n\t * Redistribution and use in source and binary forms, with or without\n\t * modification, are permitted provided that the following conditions\n\t * are met:\n\t *\n\t * 1. Redistributions of source code must retain the above copyright\n\t *    notice, this list of conditions and the following disclaimer.\n\t *\n\t * 2. Redistributions in binary form must reproduce the above copyright\n\t *    notice, this list of conditions and the following disclaimer in\n\t *    the documentation and/or other materials provided with the\n\t *    distribution.\n\t *\n\t * 3. All advertising materials mentioning features or use of this\n\t *    software must display the following acknowledgment:\n\t *    \"This product includes software developed by\n\t *     David Giffin <david@giffin.org>.\"\n\t *\n\t * 4. Redistributions of any form whatsoever must retain the following\n\t *    acknowledgment:\n\t *    \"This product includes software developed by\n\t *     David Giffin <david@giffin.org>.\"\n\t *\n\t * THIS SOFTWARE IS PROVIDED BY DAVID GIFFIN ``AS IS'' AND ANY\n\t * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n\t * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n\t * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL DAVID GIFFIN OR\n\t * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n\t * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n\t * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n\t * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n\t * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,\n\t * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n\t * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED\n\t * OF THE POSSIBILITY OF SUCH DAMAGE.\n\t */\n",
  "readmeFilename": "README.md",
  "_id": "xlrd-parser@0.1.2",
  "_from": "xlrd-parser@"
}
